---
title: "raw_analysis"
output: html_document
editor_options: 
  chunk_output_type: console
---
```{r density-theatre}
grosses%>%
  ggplot(aes(x=seats_in_theatre))+
  geom_density()
```

```{r mutate-size}
grosses_size <- grosses%>%
  mutate(theatre_size=(case_when(
    seats_in_theatre<750 ~"small",
    seats_in_theatre<1300 & seats_in_theatre>750 ~"medium",
    seats_in_theatre>1299 ~"large")
  )
  )
```

#Jeni No. 1

```{r weekly-gross-frequency}
grosses %>% 
  ggplot(aes(x = weekly_gross)) + 
  geom_histogram(stat_bin = 100) +
  labs(
    title = "Frequency of Theatres by Weekly Gross Revenue",
    x = "Weekly Gross Revenue ($)", 
    y = "Frequency"
  ) +
  scale_x_continuous(labels = label_dollar(suffix = "M", scale = 1e-6))
```

```{r avgprice-weeklygross}
grosses %>%
  ggplot(aes(y = weekly_gross,x = avg_ticket_price)) +
  geom_smooth(se = FALSE) +
  labs(title = "Relationship Between Average Ticket Price and Gross Weekly Revenue",
       x = "Average Ticket Price",
       y = "Gross Weekly Revenue") +
  scale_y_continuous(labels = label_dollar(suffix = "M", scale = 1e-6))
```

```{r model-avgprice-weeklygross}
linear_reg() %>%
  set_engine("lm") %>%
  fit(weekly_gross ~ log(avg_ticket_price), data = grosses)
```

```{r pctcapacity-weeklygross}
grosses %>% 
  ggplot(aes(x = pct_capacity, y = weekly_gross)) + 
  geom_smooth(se = FALSE) +
  labs(title = "Percentage of capacity and Weekly Gross Revenue", 
       y = "Gross Weekly Revenue", 
       x = "Percentage of Seats at Capacity") +
  scale_y_continuous(labels = label_dollar(suffix = "M", scale = 1e-6))
```

________________________________________________________________________

#Felix No. 2
```{r mutate week}
counting<-grosses_size%>%
  mutate(theatre_show=paste0(theatre,show))%>%
  group_by(theatre_show)%>%
  mutate(week_running=n())
```
```{r week running}
week_running_improved <- counting%>%
  summarise(avg_ticket_price,theatre_show,week_running)

improved<-aggregate(data=week_running_improved,
            week_running_improved$avg_ticket_price,
            by=list(theatre_show=week_running_improved$theatre_show,
                    week_running=week_running_improved$week_running), 
            FUN=mean)
```

```{r }
improved%>%
  ggplot(aes(x=week_running,y=x))+
  geom_smooth(se = FALSE)+
  labs(title = "Relaionship Between Week Running and Average Ticket Price",
       x = "Week Running",
       y = "Average Ticket Price")
```

```{r}

improved%>%
  ggplot(aes(x=week_running))+
  geom_density()+
  geom_vline(xintercept=375)


improved_2<-improved%>%
  filter(week_running<375)

improved_2%>%
  ggplot(aes(x=week_running,y=x))+
  geom_smooth(se = FALSE)+
  labs(title = "Relaionship Between Week Running and Average Ticket Price",
       x = "Week Running",
       y = "Average Ticket Price")

linear_reg_week_running<-
  linear_reg()%>%
  set_engine("lm")%>%
  fit(week_running ~ x,data=improved_2)

tidy(linear_reg_week_running)
```

```{r }
counting%>%
  ggplot(aes(x=seats_in_theatre,y=avg_ticket_price,color=theatre_size))+
  geom_smooth(se = FALSE)+
  labs(title = "Relationship Between Theatre Size and Average Ticket Price",
       x = "Seat Capacity",
       y = "Average Ticket Price")
```


